---
title: "ST558 - Vignette Project - Covid-19 Data"
author: "Jasmine Wang"
date: "10/05/2021"
#output: 
#  html_document:
#    toc: yes
#    df_print: "paged"
---

```{r setup, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(fig.path = "../images/")
```


```{r eval = FALSE, warning=FALSE, message=FALSE}
rmarkdown::render("C:/Users/peach/Documents/ST558/ST558_repos/vignette_project/_Rmd/ST558_vignette_proj.Rmd", 
                  output_format = "github_document", 
                  output_file = "C:/Users/peach/documents/ST558/ST558_repos/vignette_project/_README/README.md", 
                  output_options = list(html_preview = FALSE, toc = TRUE, df_print = "tibble")
)
```

## Writing Functions

```{r eval=FALSE}
library(httr)
library(jsonlite)
library(tidyverse)
library(countrycode)

#general_input
#country
#status_input
#date_from_input
#date_to_input
#time_from_input
#time_to_input

######## General summary/countries/all################################################
general_input <- function(gen_input, ...){
  
  input1 <- tolower(gen_input, ...) 
  option <- c("all", "summary", "countries")
  num <- charmatch(input1, option, ...)
  
  if(!is.na(num)) {
    
    status_string <- option[num]
    status_string
    
  } else {
    
    print("Sorry mate, your input is not valid! Please choose another one.")
  }
}

####### country ###############################################################
country <- function(country_name, ...){
  
  if(nchar(country_name) == 3) {
    
    nation_name <- countrycode(as.character(country_name), origin = "iso3c", destination = "country.name", ...)
    nation_name <- if_else(grepl(" ", nation_name, ignore.case = TRUE), tolower(sub(" ", "-", nation_name)), tolower(nation_name), ...)
    nation_name <- paste("country", nation_name, sep = "/", ...)
    nation_name
    
  } else if(nchar(country_name) == 2) {
    
    nation_name <- countrycode(as.character(country_name), origin = "iso2c", destination = "country.name", ...)
    nation_name <- if_else(grepl(" ", nation_name, ignore.case = TRUE), tolower(sub(" ", "-", nation_name)), tolower(nation_name), ...)
    nation_name <- paste("country", nation_name, sep = "/", ...)
    nation_name
    
  } else {
    
    nation_name <- if_else(grepl(" ", country_name, ignore.case = TRUE), tolower(sub(" ", "-", country_name)), tolower(country_name), ...)
    nation_name <- paste("country", nation_name, sep = "/", ...)
    nation_name
  }
}

#countrycode('Albania', origin = 'country.name', destination = 'iso3c')
#nation <- "usa"
#countrycode(nation, origin = "iso3c", destination = "country.name")

####### status ##################################################################
status_input <- function(status, ...){
  
  input <- tolower(status, ...)
  option <- c("confirmed", "recovered", "deaths")
  num <- charmatch(input, option, ...)
  
  if(!is.na(num)) {
    
    status_string <- paste("status", option[num], sep="/", ...)
    status_string
    
  } else {
    
    print("Sorry mate, your input is not valid! Please choose another one.")
  }
}

####### date #########################################################################
date_input_from <- function(date_from, ...){
  
  y <- c(date_from)
  y <- as_tibble(y)
  
  if(grepl("/", y$value, ignore.case = TRUE, ...)){
    
    temp <- y %>% separate(value, c("first", "second", "third"), sep="/", ...)
    
  } else if(grepl("-", y$value, ignore.case = TRUE, ...)) {
    
    temp <- y %>% separate(value, c("first", "second", "third"), sep="-", ...)
    
  } else {
    
    temp <- y %>% separate(value, c("first", "second", "third"), sep=" ", ...)
  }
  if(nchar(temp$first) == 4){
    
    if(nchar(temp$second) == 1){
      
      temp$second <- paste0("0", temp$second, ...)
      
      if(nchar(temp$third) == 1){
        
        temp$third <- paste0("0", temp$third, ...)
      }
    }
    temp <- unite(temp, date, first, second, third, sep="-", remove = TRUE, ...)
    temp$date
    
  } else {
    
    if(nchar(temp$second) == 1){
      
      temp$second <- paste0("0", temp$second, ...)
      
      if(nchar(temp$third) == 1){
        
        temp$third <- paste0("0", temp$third, ...)
      }
    }
    
    temp <- unite(temp, date, first, second, third, sep="-", remove = TRUE, ...)
    temp$date <- mdy(temp$date, ...)
    temp$date  
  }
}

date_input_to <- function(date_to, ...){
  
  y <- c(date_to)
  y <- as_tibble(y)
  
  if(grepl("/", y$value, ignore.case = TRUE, ...)){
    
    temp <- y %>% separate(value, c("first", "second", "third"), sep="/", ...)
    
  } else if(grepl("-", y$value, ignore.case = TRUE, ...)) {
    
    temp <- y %>% separate(value, c("first", "second", "third"), sep="-", ...)
    
  } else {
    
    temp <- y %>% separate(value, c("first", "second", "third"), sep=" ", ...)
  }
  if(nchar(temp$first) == 4){
    
    if(nchar(temp$second) == 1){
      
      temp$second <- paste0("0", temp$second, ...)
      
      if(nchar(temp$third) == 1){
        
        temp$third <- paste0("0", temp$third, ...)
      }
    }
    temp <- unite(temp, date, first, second, third, sep="-", remove = TRUE, ...)
    temp$date
    
  } else {
    
    if(nchar(temp$second) == 1){
      
      temp$second <- paste0("0", temp$second, ...)
      
      if(nchar(temp$third) == 1){
        
        temp$third <- paste0("0", temp$third, ...)
      }
    }
    
    temp <- unite(temp, date, first, second, third, sep="-", remove = TRUE, ...)
    temp$date <- mdy(temp$date, ...)
    temp$date  
  }
}

######### Time function #############################################################
time_input_from <- function(time_from, ...){
  
  times <- c(time_from)
  times <- as_tibble(times)
  
  if(grepl(":", times$value, ignore.case = TRUE, ...)) {
    
    times <- times %>% separate(value, c("first", "second", "third"), sep=":", ...)
    
  } else if(grepl("-", times$value, ignore.case = TRUE, ...)) {
    
    times <- times %>% separate(value, c("first", "second", "third"), sep="-", ...)
    
  } else if(grepl("/", times$value, ignore.case = TRUE, ...)) {
    
    times <- times %>% separate(value, c("first", "second", "third"), sep="/", ...)
    
  }
  
  if(nchar(times$first) == 1){
    
    times$first <- paste0("0", times$first, ...)
    
    if(nchar(times$second) == 1){
      
      times$second <- paste0("0", times$second, ...)
      
      if(nchar(times$third) == 1){
        
        times$third <- paste0("0", times$third, ...)
        
      }
    }
  }
  
  if(as.numeric(times$first) %in% c(0:23)){
    
    if(as.numeric(times$second) %in% c(0:59)){
      
      if(as.numeric(times$third) %in% c(0:59)){
        
        
        times <- unite(times, value, first, second, third, sep=":", remove = TRUE, ...)
        times$value
        
      } else {
        
        print("Sorry mate, your input is not valid! Please choose a time between 0 and 59 seconds.")
        
      }
    } else {
      
      print("Sorry mate, your input is not valid! Please choose a time between 0 and 59 minutes.")
      
    }
  } else {
    
    print("Sorry mate, your input is not valid! Please choose a military time between 0 and 23 hours.")
    
  }
}

time_input_to <- function(time_to, ...){
  
  times <- c(time_to)
  times <- as_tibble(times)
  
  if(grepl(":", times$value, ignore.case = TRUE, ...)) {
    
    times <- times %>% separate(value, c("first", "second", "third"), sep=":", ...)
    
  } else if(grepl("-", times$value, ignore.case = TRUE, ...)) {
    
    times <- times %>% separate(value, c("first", "second", "third"), sep="-", ...)
    
  } else if(grepl("/", times$value, ignore.case = TRUE, ...)) {
    
    times <- times %>% separate(value, c("first", "second", "third"), sep="/", ...)
    
  }
  
  if(nchar(times$first) == 1){
    
    times$first <- paste0("0", times$first, ...)
    
    if(nchar(times$second) == 1){
      
      times$second <- paste0("0", times$second, ...)
      
      if(nchar(times$third) == 1){
        
        times$third <- paste0("0", times$third, ...)
        
      }
    }
  }
  
  if(as.numeric(times$first) %in% c(0:23)){
    
    if(as.numeric(times$second) %in% c(0:59)){
      
      if(as.numeric(times$third) %in% c(0:59)){
        
        
        times <- unite(times, value, first, second, third, sep=":", remove = TRUE, ...)
        times$value
        
      } else {
        
        print("Sorry mate, your input is not valid! Please choose a time between 0 and 59 seconds.")
        
      }
    } else {
      
      print("Sorry mate, your input is not valid! Please choose a time between 0 and 59 minutes.")
      
    }
  } else {
    
    print("Sorry mate, your input is not valid! Please choose a military time between 0 and 23 hours.")
    
  }
}

############# A P I ##########################################################################
ref_general <- function(gen_input = "countries", ...){
  
  info1 <- general_input(gen_input, ...)
  
  api_url <- if_else(info1 %in% c("all", "summary", "countries"), 
                     paste("https://api.covid19api.com", info1, sep = "/"), info1, ...)
  api_url
  
}

#dayone all status
dayone_all_status <- function(country_name = "BB", ...){
  
  info2 <- country(country_name, ...)
  
  api_url <- paste("https://api.covid19api.com/dayone", info2, sep = "/", ...)
  api_url
  
}

#dayone with STATUS
dayone_status <- function(country_name = "BB", status = "confirmed", ...){
  
  info2 <- country(country_name, ...)
  info3 <- status_input(status, ...)
  
  api_url <- paste("https://api.covid19api.com/dayone", info2, info3, sep = "/", ...)
  api_url
  
}

dayone_status_live <- function(country_name = "BB", status = "confirmed", ...){
  
  info2 <- country(country_name, ...)
  info3 <- status_input(status, ...)
  
  api_url <- paste("https://api.covid19api.com/dayone", info2, info3, "live", sep = "/", ...)
  api_url
  
}

#by country ALL status from date time to date time 
datetime_specific_all_status <- function(country_name="BB", date_from="2020-05-01", date_to="2020-05-03", 
                                             time_from="00:00:00", time_to="00:00:00", ...){
  
  info2 <- country(country_name, ...)
  
  date1 <- date_input_from(date_from, ...)
  date2 <- date_input_to(date_to, ...)
  time1 <- time_input_from(time_from, ...)
  time2 <- time_input_to(time_to, ...)
  
  latter <- paste0("?from=", date1, "T", time1, "Z&to=", date2, "T", time2, "Z", ...)
  api_url <- paste0("https://api.covid19api.com/", info2, latter, ...)
  api_url
  
}

#by country with STATUS from date time to date time
datetime_specific_status <- function(country_name="BB", status="confirmed", date_from="2020-05-01", date_to="2020-05-03", 
                                         time_from="00:00:00", time_to="00:00:00", ...){
  
  info2 <- country(country_name, ...)
  info3 <- status_input(status, ...)
  
  date1 <- date_input_from(date_from, ...)
  date2 <- date_input_to(date_to, ...)
  time1 <- time_input_from(time_from, ...)
  time2 <- time_input_to(time_to, ...)
  
  latter <- paste0("?from=", date1, "T", time1, "Z&to=", date2, "T", time2, "Z", ...)
  api_url <- paste0("https://api.covid19api.com/", info2, "/", info3, latter, ...)
  api_url
  
}

live_all_status <- function(country_name = "BB", ...){
  
    info2 <- country(country_name, ...)
  
  api_url <- paste("https://api.covid19api.com/live", info2, sep = "/", ...)
  api_url
  
}

live_status <- function(country_name = "BB", status = "confirmed", ...){
  
  info2 <- country(country_name, ...)
  info3 <- status_input(status, ...)
  
  api_url <- paste("https://api.covid19api.com/live", info2, info3, sep = "/", ...)
  api_url
  
}

live_status_after_date <- function(country_name = "BB", status = "confirmed", 
                                   date_from="2020-05-01", time_from="00:00:00", ...){
  
  info2 <- country(country_name, ...)
  info3 <- status_input(status, ...)
  
  date1 <- date_input_from(date_from, ...)
  time1 <- time_input_from(time_from, ...)
  datetime <- paste0(date_from, "T", time_from, "Z", ...)
  
  api_url <- paste("https://api.covid19api.com/live", info2, info3, "date", datetime,  sep = "/", ...)
  api_url
  
}

choose_api <- function(type, ...) {
  
  switch(type,
         
         general = ref_general(...),
         option1 = dayone_all_status(...),
         option2 = dayone_status(...),
         option3 = dayone_status_live(...),
         option4 = datetime_specific_all_status(...),
         option5 = datetime_specific_status(...),
         option6 = live_all_status(...),
         option7 = live_status(...),
         option8 = live_status_after_date(...)
  )
}

choose_api(9)

get_data <- function(type, ...){
  
  api_url <- choose_api(type, ...)
  json_data <- GET(api_url)
  extract_data <- rawToChar(json_data$content)
  usable_form <- fromJSON(extract_data)
  usable_form
  
}

get_data(3)


choose_api(5, "usa", date_to="5 6 2021", time_to="5:4:23")


```



Function(s)                  | Argument(s)                                                  | Default(s)
---------------------------- | ------------------------------------------------------------ | -------------------------
ref_general                  | gen_input                                                    | None
---------------------------- | ------------------------------------------------------------ | -------------------------
dayone_all_status            | country_name                                                 | country_name = "BB"
---------------------------- | ------------------------------------------------------------ |
dayone_status                | country_name, status                                         | status = "confirmed"
---------------------------- | ------------------------------------------------------------ |
dayone_status_live           | country_name, status                                         | date_from = "2020-05-01"
---------------------------- | ------------------------------------------------------------ |
datetime_specific_all_status | country_name, date_from, date_to, time_from, time_to         | date_to = "2020-05-03"
---------------------------- | ------------------------------------------------------------ |
datetime_specific_status     | country_name, status, date_from, date_to, time_from, time_to | time_from = "00:00:00"
---------------------------- | ------------------------------------------------------------ |
live_all_status              | country_name                                                 | time_to = "00:00:00"
---------------------------- | ------------------------------------------------------------ |
live_status                  | country_name, status                                         |
---------------------------- | ------------------------------------------------------------ |
live_status_after_date       | country_name, status, date_from, time_from                   |



general = ref_general(...),
         option1 = dayone_all_status(...),
         option2 = dayone_status(...),
         option3 = dayone_status_live(...),
         option4 = datetime_specific_all_status(...),
         option5 = datetime_specific_status(...),
         option6 = live_all_status(...),
         option7 = live_status(...),
         option8 = live_status_after_date(...)

## Getting an API

```{r eval=FALSE}
library(httr)
library(jsonlite)
library(tidyverse)
library(countrycode)

dec_1 <- get_data(5, "usa", date_from="2020 12 31", date_to="2020 12 31", time_to="23:59:59")
jan_1 <- get_data(5, "usa", date_from="2021 1 31", date_to="2021 1 31", time_to="23:59:59")
feb_1 <- get_data(5, "usa", date_from="2021 2 28", date_to="2021 2 28", time_to="23:59:59")
mar_1 <- get_data(5, "usa", date_from="2021 3 31", date_to="2021 3 31", time_to="23:59:59")
apr_1 <- get_data(5, "usa", date_from="2021 4 30", date_to="2021 4 30", time_to="23:59:59")
may_1 <- get_data(5, "usa", date_from="2021 5 31", date_to="2021 5 31", time_to="23:59:59")
jun_1 <- get_data(5, "usa", date_from="2021 6 30", date_to="2021 6 30", time_to="23:59:59")
jul_1 <- get_data(5, "usa", date_from="2021 7 31", date_to="2021 7 31", time_to="23:59:59")
aug_1 <- get_data(5, "usa", date_from="2021 8 31", date_to="2021 8 31", time_to="23:59:59")
sep_1 <- get_data(5, "usa", date_from="2021 9 30", date_to="2021 9 30", time_to="23:59:59")

dec_4 <- dec_1 %>% select(Province, Confirmed, Deaths, Active, Date) 
jan_4 <- jan_1 %>% select(Province, Confirmed, Deaths, Active, Date)
feb_4 <- feb_1 %>% select(Province, Confirmed, Deaths, Active, Date)
mar_4 <- mar_1 %>% select(Province, Confirmed, Deaths, Active, Date)
apr_4 <- apr_1 %>% select(Province, Confirmed, Deaths, Active, Date)
may_4 <- may_1 %>% select(Province, Confirmed, Deaths, Active, Date)
jun_4 <- jun_1 %>% select(Province, Confirmed, Deaths, Active, Date)
jul_4 <- jul_1 %>% select(Province, Confirmed, Deaths, Active, Date)
aug_4 <- aug_1 %>% select(Province, Confirmed, Deaths, Active, Date)
sep_4 <- sep_1 %>% select(Province, Confirmed, Deaths, Active, Date)

```





```{r eval=FALSE}
library(httr)
library(jsonlite)
library(tidyverse)
library(dplyr)

# url <- "https://api.covid19api.com/country/united-states?from=2020-03-01T00:00:00Z&to=2020-04-01T00:00:00Z"
dec_1 <- GET("https://api.covid19api.com/country/united-states?from=2020-12-31T00:00:00Z&to=2020-12-31T23:59:59Z")
jan_1 <- GET("https://api.covid19api.com/country/united-states?from=2021-01-31T00:00:00Z&to=2021-01-31T23:59:59Z")
feb_1 <- GET("https://api.covid19api.com/country/united-states?from=2021-02-28T00:00:00Z&to=2021-02-28T23:59:59Z")
mar_1 <- GET("https://api.covid19api.com/country/united-states?from=2021-03-31T00:00:00Z&to=2021-03-31T23:59:59Z")
apr_1 <- GET("https://api.covid19api.com/country/united-states?from=2021-04-30T00:00:00Z&to=2021-04-30T23:59:59Z")
may_1 <- GET("https://api.covid19api.com/country/united-states?from=2021-05-31T00:00:00Z&to=2021-05-31T23:59:59Z")
jun_1 <- GET("https://api.covid19api.com/country/united-states?from=2021-06-30T00:00:00Z&to=2021-06-30T23:59:59Z")
jul_1 <- GET("https://api.covid19api.com/country/united-states?from=2021-07-31T00:00:00Z&to=2021-07-31T23:59:59Z")
aug_1 <- GET("https://api.covid19api.com/country/united-states?from=2021-08-31T00:00:00Z&to=2021-08-31T23:59:59Z")
sep_1 <- GET("https://api.covid19api.com/country/united-states?from=2021-09-30T00:00:00Z&to=2021-09-30T23:59:59Z")

dec_2 <- rawToChar(dec_1$content)
jan_2 <- rawToChar(jan_1$content)
feb_2 <- rawToChar(feb_1$content)
mar_2 <- rawToChar(mar_1$content)
apr_2 <- rawToChar(apr_1$content)
may_2 <- rawToChar(may_1$content)
jun_2 <- rawToChar(jun_1$content)
jul_2 <- rawToChar(jul_1$content)
aug_2 <- rawToChar(aug_1$content)
sep_2 <- rawToChar(sep_1$content)

dec_3 <- fromJSON(dec_2)
jan_3 <- fromJSON(jan_2)
feb_3 <- fromJSON(feb_2)
mar_3 <- fromJSON(mar_2)
apr_3 <- fromJSON(apr_2)
may_3 <- fromJSON(may_2)
jun_3 <- fromJSON(jun_2)
jul_3 <- fromJSON(jul_2)
aug_3 <- fromJSON(aug_2)
sep_3 <- fromJSON(sep_2)

dec_4 <- dec_3 %>% select(Province, Deaths, Active, Date) 
jan_4 <- jan_3 %>% select(Province, Deaths, Active, Date)
feb_4 <- feb_3 %>% select(Province, Deaths, Active, Date)
mar_4 <- mar_3 %>% select(Province, Deaths, Active, Date)
apr_4 <- apr_3 %>% select(Province, Deaths, Active, Date)
may_4 <- may_3 %>% select(Province, Deaths, Active, Date)
jun_4 <- jun_3 %>% select(Province, Deaths, Active, Date)
jul_4 <- jul_3 %>% select(Province, Deaths, Active, Date)
aug_4 <- aug_3 %>% select(Province, Deaths, Active, Date)
sep_4 <- sep_3 %>% select(Province, Deaths, Active, Date)

data_1 <- rbind(jan_4, feb_4, mar_4, apr_4, may_4, jun_4, jul_4, aug_4, sep_4)
data_2 <- rbind(dec_4, jan_4, feb_4, mar_4, apr_4, may_4, jun_4, jul_4, aug_4)

data_11 <- data_1 %>% group_by(Province, Date) %>% summarise(across(c(Deaths, Active), sum))
data_11
data_22 <- data_2 %>% group_by(Province, Date) %>% summarise(across(c(Deaths, Active), sum))
names(data_22) <- c("State", "Date2", "Deaths2", "Active2")
mydata1 <- cbind(data_11, data_22)
mydata1
mydata2 <- mydata1 %>% mutate(Death = Deaths - Deaths2, Cases = Active - Active2, Total = Death + Cases, 
                              Month = rep(c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep"))) %>% 
  select(State, Month, Death, Cases, Total)

write_csv(x = mydata2, path = "../_Data/covid_data.csv")

```



```{r eval=FALSE}
`%!in%` <- Negate(`%in%`)

mydata3 <- mydata2 %>% filter(Province %!in% c("American Samoa", "Diamond Princess", "Grand Princess", "Guam", "Northern Mariana Islands", "Puerto Rico", "Virgin Islands")) %>% 
  mutate(f500_deaths = if_else(Death < 500, "Less than 500 deaths", "More than 500 deaths"), 
         Total_cases = if_else(Total < 9000, "1. Less than 9000", 
                             if_else(Total < 30000, "2. Between 9000 and 30,000", "3. More than 30,000")), 
         vaccine = if_else(Month %in% c("Jan", "Feb", "Mar", "Apr"), "1. Vaccine-ing", 
                           if_else(Month %in% c("May", "Jun", "Jul"), "2. Some vaccined", "3. Back to school")))
dim(mydata3)
names(mydata3)
# 1st contingency table
table(mydata3$Total_cases, mydata3$vaccine)

# 2nd contingency table
mydata3 %>% filter(Province %in% c("California", "New York", "Florida", "Texas", "Michigan", "North Carolina")) %>% 
  select(Province, Month, Death) %>%
  pivot_wider(names_from = "Month", values_from = "Death") %>% arrange(desc(Jan))
# 3rd contingency table
mydata3 %>% filter(Province %in% c("California", "New York", "Florida", "Texas", "Michigan", "North Carolina")) %>% 
  select(Province, Month, Total) %>%
  pivot_wider(names_from = "Month", values_from = "Total") %>% arrange(desc(Jan))

# summaries
summary3 <- mydata3 %>% group_by(Province, vaccine) %>% 
  summarise(avg_total = round(mean(Total)), sd_total = round(sd(Total)), median_total = round(median(Total)), IQR_total = round(IQR(Total)))

summary4 <- mydata3 %>% group_by(Province, vaccine) %>% 
  summarise(avg_death = mean(Death), sd_death = sd(Death), median_death = median(Death), IQR_death = IQR(Death))

```


```{r eval=FALSE}
library(tidyverse)
library(ggplot2)

barplot1 <- summary3 %>% filter(Province %in% c("California", "New York", "Florida", "Texas", "Michigan", "North Carolina"))
g <- ggplot(data = barplot1, aes(x = Province, y = avg_total, fill = vaccine))
g + geom_bar(stat = "identity", position = "dodge") + 
  labs(x = "State", y = "Average Total Cases", title = "Figure 1. Average total cases at each timeline for each state") + 
  scale_fill_discrete(name = "Vaccine timeline") + 
  theme(axis.text.x = element_text(angle = 45, size = 10), 
        axis.text.y = element_text(size = 10), 
        axis.title.x = element_text(size = 13), 
        axis.title.y = element_text(size = 13), 
        legend.key.size = unit(1, 'cm'), 
        legend.text = element_text(size = 13), 
        title = element_text(size = 15))

barplot2 <- summary4 %>% filter(Province %in% c("California", "New York", "Florida", "Texas", "Michigan", "North Carolina"))
d <- ggplot(data = barplot2, aes(x = Province, y = avg_death, fill = vaccine))
d + geom_bar(stat = "identity", position = "dodge") + 
  labs(x = "State", y = "Average Total Cases", title = "Figure 2. Average total deaths at each timeline for each state") + 
  scale_fill_discrete(name = "Vaccine timeline") + 
  theme(axis.text.x = element_text(angle = 45, size = 10), 
        axis.text.y = element_text(size = 10), 
        axis.title.x = element_text(size = 13), 
        axis.title.y = element_text(size = 13), 
        legend.key.size = unit(1, 'cm'), 
        legend.text = element_text(size = 13), 
        title = element_text(size = 15))

# mydata3

boxplot1 <- ggplot(data = mydata3, aes(x = vaccine, y = Total))
boxplot1 + geom_boxplot(fill = "white", outlier.shape = NA) + 
  coord_cartesian(ylim=c(0, 300000)) + 
  geom_jitter(aes(color = vaccine), size = 3) + 
  labs(title = "Figure 3. Boxplot for total number of cases") + 
  theme(axis.text.x = element_text(size = 10), 
        axis.text.y = element_text(size = 10), 
        axis.title.x = element_text(size = 15), 
        axis.title.y = element_text(size = 15), 
        legend.key.size = unit(1, 'cm'), 
        legend.text = element_text(size = 13), 
        title = element_text(size = 15))

boxplot2 <- ggplot(data = mydata3, aes(x = vaccine, y = Death))
boxplot2 + geom_boxplot(fill = "white", outlier.shape = NA) + 
  coord_cartesian(ylim=c(0, 10000)) + 
  geom_jitter(aes(color = vaccine), size = 3) + 
  labs(title = "Figure 4. Boxplot for total number of deaths") + 
  theme(axis.text.x = element_text(size = 10), 
        axis.text.y = element_text(size = 10), 
        axis.title.x = element_text(size = 15), 
        axis.title.y = element_text(size = 15), 
        legend.key.size = unit(1, 'cm'), 
        legend.text = element_text(size = 13), 
        title = element_text(size = 15))

scatter <- ggplot(data = mydata3, aes(x = Cases, y = Death, color = vaccine))
scatter + geom_point(aes(shape = Total_cases), size = 3) + 
  coord_cartesian(xlim=c(0, 1000000), ylim=c(0, 20000)) +
  geom_smooth(method = lm, lwd = 2) + 
  labs(title = "Figure 5. Scappterplot: Number of cases vs Deaths") + 
  theme(axis.text.x = element_text(size = 10), 
        axis.text.y = element_text(size = 10), 
        axis.title.x = element_text(size = 15), 
        axis.title.y = element_text(size = 15), 
        legend.key.size = unit(1, 'cm'), 
        legend.text = element_text(size = 13), 
        title = element_text(size = 15))

his <- ggplot(data = mydata3, aes(x = Total))
his + geom_histogram() + 
  coord_cartesian(xlim=c(0, 1000000)) + 
  labs(title = "Figure 6. Histogram of Total Cases via Timelines") + 
  theme(axis.text.x = element_text(size = 10), 
        axis.text.y = element_text(size = 10), 
        axis.title.x = element_text(size = 15), 
        axis.title.y = element_text(size = 15), 
        legend.key.size = unit(1, 'cm'), 
        legend.text = element_text(size = 13), 
        title = element_text(size = 15))

# mydata3$Month <- ordered(mydata3$Month, levels = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep"))
mydata3$Month <- factor(mydata3$Month, levels = unique(mydata3$Month))

neighbor <- mydata3 %>% filter(State %in% c("North Carolina", "South Carolina", "Tennessee","Georgia", "Kentucky", "Virginia", "West Virginia"))
lineplot1 <- ggplot(data = neighbor, aes(x = Month, y = Total, color = State))
lineplot1 + geom_line(aes(group = State)) + geom_point() + 
  labs(title = "Figure 7. Line plot: Total cases of NC and its neighbors") + 
  theme(axis.text.x = element_text(size = 10), 
        axis.text.y = element_text(size = 10), 
        axis.title.x = element_text(size = 15), 
        axis.title.y = element_text(size = 15), 
        legend.key.size = unit(1, 'cm'), 
        legend.text = element_text(size = 13), 
        title = element_text(size = 15))

lineplot1 <- ggplot(data = neighbor, aes(x = Month, y = Death, color = State))
lineplot1 + geom_line(aes(group = State)) + geom_point() + 
  labs(title = "Figure 8. Line plot: Total deaths of NC and its neighbors") + 
  theme(axis.text.x = element_text(size = 10), 
        axis.text.y = element_text(size = 10), 
        axis.title.x = element_text(size = 15), 
        axis.title.y = element_text(size = 15), 
        legend.key.size = unit(1, 'cm'), 
        legend.text = element_text(size = 13), 
        title = element_text(size = 15))

```



## Welcome to GitHub Pages

You can use the [editor on GitHub](https://github.com/peachgal/vignette_project/edit/main/README.md) to maintain and preview the content for your website in Markdown files.

Whenever you commit to this repository, GitHub Pages will run [Jekyll](https://jekyllrb.com/) to rebuild the pages in your site, from the content in your Markdown files.

### Markdown

Markdown is a lightweight and easy-to-use syntax for styling your writing. It includes conventions for

```markdown
Syntax highlighted code block

# Header 1
## Header 2
### Header 3

- Bulleted
- List

1. Numbered
2. List

**Bold** and _Italic_ and `Code` text

[Link](url) and ![Image](src)
```

For more details see [GitHub Flavored Markdown](https://guides.github.com/features/mastering-markdown/).

### Jekyll Themes

Your Pages site will use the layout and styles from the Jekyll theme you have selected in your [repository settings](https://github.com/peachgal/vignette_project/settings/pages). The name of this theme is saved in the Jekyll `_config.yml` configuration file.

### Support or Contact

Having trouble with Pages? Check out our [documentation](https://docs.github.com/categories/github-pages-basics/) or [contact support](https://support.github.com/contact) and weâ€™ll help you sort it out.

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

